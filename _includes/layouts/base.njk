<!doctype html>
<html lang="en">
  <head>
    {# IMPORTANT: we have to check localStorage as soon as page loads to prevent flickering #}
    <script>
      const currentTheme = localStorage.getItem('theme') || 'light'
      document.documentElement.setAttribute('data-theme', currentTheme)
    </script>
    {# Palette color #}
    {% set colors = [
      { num: 1, lighten: '#f37694' },
      { num: 2, lighten: '#d7e5ff' },
      { num: 3, lighten: '#adffe9' },
      { num: 4, lighten: '#ace1ff' },
      { num: 5, lighten: '#ffe3bd' }
    ] %}
    {% set randColor = colors | random %}
    {% set color = randColor %}
    {% if paletteColor %}
      {% for item in colors %}
        {% if item.num === paletteColor %}
          {% set color = item %}
        {% endif %}
      {% endfor %}
    {% endif %}
    {# info #}
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title or renderData.title | striptags }} | Giulia Chiola</title>
    {# search engine #}
    <meta name="robots" content="index,follow"><!-- All Search Engines -->
    {# archive #}
    <link rel="archives" href="{{ global.siteUrl | url }} + '/search'">
    {# theme color #}
    <meta name="theme-color" content="{{ color.lighten }}">
    {# favicon #}
    <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-touch-icon-color-{{ color.num }}.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32-color-{{ color.num }}.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16-color-{{ color.num }}.png">
    <link rel="manifest" href="/site-color-{{ color.num }}.webmanifest">
    {# og, twitter, SEO #}
    {% include 'layouts/meta.njk' %}

    {# css #}
    <link rel="stylesheet" href="/css/css-bundle.css">

    {# critical css #}
    {# capture the CSS content as a Nunjucks variable #}
    {% set css %}
      {% include "super-styleguide/src/css/critical.css" %}
    {% endset %}
    {# feed it through our cssmin filter to minify #}
    <style>
      {{ css | cssmin | safe }}
    </style>

    {# fonts #}
    {% set fontsPath = "https://fonts.googleapis.com/css2?family=Fira+Code&family=Montserrat:wght@400;600&display=swap" %}
    <link rel="preconnect"
      href="https://fonts.gstatic.com"
      crossorigin />

    <link rel="preload"
          as="style"
          href={{ fontsPath }} />

    <link rel="stylesheet"
          href={{ fontsPath }}
          media="print" onload="this.media='all'" />

    <noscript>
      <link rel="stylesheet"
            href={{ fontsPath }} />
    </noscript>
  </head>

  <body>
    <div class="l-wrapper t-palette-color--{{ color.num }}">
      {# header #}
      {% include 'layouts/partials/header.njk' %}

      {# base content #}
      {% include './base-content.njk' %}

      {# footer #}
      {% include 'layouts/partials/footer.njk' %}
    </div>

    {# scripts from styleguide #}
    {% if category === 'tutorials' %}
    <script defer src="https://cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js"></script>
    {% endif %}
    <script defer src="/js/js-bundle.js"></script>
    {# JS #}
  </body>
</html>
